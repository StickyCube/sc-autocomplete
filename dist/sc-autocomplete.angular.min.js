!function(){function a(a){this.dropdown=f(a[0],j.List),this.searchables={},this.searchItems={},this.searchResults=[],this.callbacks={},e(a[0])}function b(a){return void 0!==a&&null!==a}function c(a){return b(a)&&(a.constructor===Array||a.constructor===Object)}function d(a){return b(a)&&a.constructor===Array}function e(a){var b=f(a,j.ScreenCover);b&&(g(b,"position","fixed"),g(b,"top",0),g(b,"left",0),g(b,"width","100%"),g(b,"height","100%"),g(b,"background-color","transparent"),g(b,"z-index",1))}function f(a,b){var c=a.getElementsByClassName(b);return 1!==c.length?null:c[0]}function g(a,b,c){if(i()||!a.setAttribute)return void(a.style[h(b)]=c);var d=a.getAttribute("style")||"";d+=b+":"+c+";",a.setAttribute("style",d)}function h(a){var b="";return a.split("-").forEach(function(a,c){return 0===c?void(b+=a):(b+=a[0].toUpperCase(),void(b+=a.substr(1)))}),b}function i(){return-1!==window.navigator.userAgent.indexOf("MSIE")}var j={List:"sc-autocomplete-list",ListItem:"sc-autocomplete-listitem",ScreenCover:"sc-autocomplete-screencover"};a.prototype.constructor=a,a.prototype.searchText="",a.prototype.activeIndex=0,a.prototype.dropdown=null,a.prototype.searchables=null,a.prototype.searchItems=null,a.prototype.searchResults=null,a.prototype.callbacks=null,a.prototype.recompile=function(a){if(c(a)){this.searchables=a,this.searchItems={};var b=d(a),e=function(a){return a.trim().toLowerCase()};for(var f in a)if(a.hasOwnProperty(f)){var g=a[f],h=b?g:f,i=b?[g]:g.split("|").concat(f);this.searchItems[h]=i.map(e)}}},a.prototype.scrollTo=function(a){var b,c,d,e,f;b=this.dropdown.getElementsByClassName(j.ListItem),a>=b.length||0>a||(b=b[a],c=b.offsetTop,d=c+b.offsetHeight,e=this.dropdown.scrollTop,f=this.dropdown.offsetHeight,d>e+f?this.dropdown.scrollTop=d-f:e>c&&(this.dropdown.scrollTop=c))},a.prototype.search=function(){var a=this,b=function(b){return b.indexOf(a.searchText.toLowerCase())>-1};this.searchResults.length=0;for(var c in this.searchItems)if(this.searchItems.hasOwnProperty(c)){var d=this.searchItems[c];d.some(b)&&this.searchResults.push(c)}},a.prototype.onKeydown=function(a){if(this.searchResults.length)switch(a.keyCode){case 27:a.preventDefault(),a.stopPropagation(),this.cancelSelection();break;case 38:a.preventDefault(),a.stopPropagation(),this.selectOptionAt(this.activeIndex-1);break;case 40:a.preventDefault(),a.stopPropagation(),this.selectOptionAt(this.activeIndex+1);break;case 13:a.preventDefault(),a.stopPropagation(),this.onSelect(this.activeIndex)}},a.prototype.cancelSelection=function(){this.setSelection(""),this.activeIndex=0,this.searchResults.length=0},a.prototype.onSelect=function(a){var b=this.searchResults[a];this.setSelection(b),this.activeIndex=0,this.searchResults.length=0},a.prototype.onBlur=function(){var a=Object.keys(this.searchItems);-1==a.indexOf(this.searchText)&&this.setSelection(""),this.activeIndex=0,this.searchResults.length=0},a.prototype.selectOptionAt=function(a){0>a?a=0:a>=this.searchResults.length&&(a=this.searchResults.length-1),this.activeIndex=a,this.setText(this.searchResults[a]),this.scrollTo(a)},a.prototype.on=function(a,b){d(this.callbacks[a])||(this.callbacks[a]=[]),this.callbacks[a].push(b)},a.prototype.trigger=function(a){if(d(this.callbacks[a])){var b=Array.prototype.slice.call(arguments,1);this.callbacks[a].forEach(function(a){a.apply(null,b)})}},a.prototype.setText=function(a){this.searchText=a,this.trigger("text-changed",a)},a.prototype.setSelection=function(a){this.searchText=this.selection=a,this.trigger("selection-changed",a)},angular.module("sc-autocomplete",[]).directive("scAutocomplete",[function(){return{restrict:"E",templateUrl:"sc-autocomplete.html",scope:{selection:"=ngModel",scAutocompleteSearchables:"="},replace:!0,link:function(c,d){c.sc=new a(d),c.sc.on("selection-changed",function(a){c.selection=a}),c.$watch("scAutocompleteSearchables",function(a){b(a)&&c.sc.recompile(a)},!0),angular.isDefined(c.selection)&&(c.sc.searchText=c.selection)}}}])}();